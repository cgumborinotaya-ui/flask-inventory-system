{% extends 'base.html' %}

{% block content %}
<div class="mb-3 d-flex justify-content-between align-items-center">
  <h2>Printable Report</h2>
  <a href="{{ url_for('reports', type=report_type) }}" class="btn btn-secondary">Back</a>
</div>
<p class="text-muted">Use your browser's Print feature to save as PDF.</p>

<div class="table-responsive">
  <table class="table table-bordered">
    <thead>
      <tr>
        <th>ID</th>
        <th>Name</th>
        <th>Type</th>
        <th>Serial</th>
        <th>Purchase Date</th>
        <th>Status</th>
        <th>Assigned To</th>
        <th>Supplier</th>
        <th>Province</th>
        <th>District</th>
        <th>OS</th>
        <th>Antivirus</th>
        <th>Office</th>
        <th>EOL Date</th>
        <th>EOL Status</th>
        <th>Inspected</th>
        <th>Inspection Date</th>
        {% if report_type == 'routine_service_due' %}
        <th>Last Service Date</th>
        <th>Next Service Due</th>
        <th>Days To Due</th>
        <th>Service Status</th>
        {% endif %}
      </tr>
    </thead>
    <tbody>
      {% for a in assets %}
      <tr>
        <td>{{ a.id }}</td>
        <td>{{ a.name }}</td>
        <td>{{ a.type }}</td>
        <td>{{ a.serial_number }}</td>
        <td>{{ a.purchase_date or '-' }}</td>
        <td>{{ a.status }}</td>
        <td>{{ a.assigned_to or '-' }}</td>
        <td>{{ a.supplier or '-' }}</td>
        <td>{{ a.province or '-' }}</td>
        <td>{{ a.district or '-' }}</td>
        <td>{{ a.os_name or '-' }}</td>
        <td>{{ a.antivirus_name or '-' }}</td>
        <td>{{ a.office_name or '-' }}</td>
        <td>{{ a.eol_date or '-' }}</td>
        <td>{{ a.eol_status or '-' }}</td>
        <td>{{ 'Yes' if a.inspected_by_ict else 'No' }}</td>
        <td>{{ a.inspection_date or '-' }}</td>
        {% if report_type == 'routine_service_due' %}
        <td>{{ a.last_service_date or '-' }}</td>
        <td>{{ a.routine_service_due_date or '-' }}</td>
        <td>
          {% if a.routine_service_due_date %}
            {{ (a.routine_service_due_date - today).days }}
          {% else %}
            -
          {% endif %}
        </td>
        <td>
          {% if a.is_routine_service_due %}
            Due
          {% elif a.is_routine_service_due_soon %}
            Due Soon
          {% else %}
            OK
          {% endif %}
        </td>
        {% endif %}
      </tr>
      {% else %}
      <tr>
        <td colspan="{% if report_type == 'routine_service_due' %}21{% else %}17{% endif %}" class="text-center">No data</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>
{% endblock %}
